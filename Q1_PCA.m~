%% Q1 - PCA for each set of faces


close all
clear all
clc

load Separated_Data

detrend_faces = [];
mean_faces = zeros(2576,52,'double');
faceCov = zeros(2576,2576,52,'double');

for i = 1:52
    % Compute mean face and subtract it from all 8 faces. Repeat for 52
    % different faces
    mean_faces(:,i) = mean(training(:,(i-1)*8+1:i*8),2);
    detrend_faces = [detrend_faces (training(:,(i-1)*8+1:i*8) - mean_faces(:,i))];
    
    % Compute covariance matrix for each face set
    % T
    faceCov(:,:,i) = 0.125*(detrend_faces(:,(i-1)*8+1:i*8)*detrend_faces(:,(i-1)*8+1:i*8)');
end

